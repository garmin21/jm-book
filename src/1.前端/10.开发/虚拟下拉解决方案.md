---
title: è™šæ‹Ÿä¸‹æ‹‰è§£å†³æ–¹æ¡ˆ el-select-v2
author: æå˜‰æ˜
createTime: 2024/05/01 15:10:05
permalink: /article/wgtb5128/
tags:
  - FE
---

åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œä½¿ç”¨`element-ui`ç»„ä»¶åº“ï¼Œä½¿ç”¨ä¸‹æ‹‰åˆ—è¡¨æ—¶ï¼Œå‘ç°**åŸå‹å›¾ä¸ç»„ä»¶æä¾›çš„æ•ˆæœå›¾æœ‰å·®å¼‚**,è¿™ä¸ªæ—¶å€™å°±å¯èƒ½éœ€è¦æˆ‘ä»¬è¿›è¡Œ è¿›è¡Œ`ç»„ä»¶ç»„åˆä½¿ç”¨` æ¯”å¦‚ `el-checkbox` ä¸ `el-select` å»è¿›è¡Œç»„åˆå¼€å‘ã€‚

- [æ–‡æ¡£åœ°å€](https://github.com/kooriookami/el-select-v2/tree/master)

ä¾‹å­ï¼š

![el-checkbox+el-select](/images/element-ui/01.png)

å†æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è€ƒè™‘åˆ°ï¼Œå¦‚æœ select æ¸²æŸ“çš„ option è¿‡å¤šï¼Œå°±ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå¯èƒ½åœ¨ä½ é¡µé¢æ‰“å¼€ï¼Œ1~3s åï¼Œä½ æ‰èƒ½çœŸæ­£çš„å»é€‰æ‹©ã€‚è¿™æ · å¦‚æœè€æ¿æœ‰è¦æ±‚ ğŸ˜‚ï¼Œé‚£ä¹ˆå°±è¦å»ï¼Œä¼˜åŒ–å®ƒã€‚ä¸šç•Œæœ€å¸¸è§çš„è§£å†³ å°±æ˜¯ è™šæ‹Ÿæ»šåŠ¨ã€‚ è™šæ‹Ÿæ»šåŠ¨çš„åŸç†ï¼švue è™šæ‹Ÿæ»šåŠ¨æ’ä»¶ [vue-virtual-scroller](/article/kdz7kuwf/) åœ¨è¿™ç¯‡æ–‡ç« æœ‰è§£é‡Š

## ç”¨æ³•

```js
import Vue from 'vue';
// å¿…é¡»å¼•å…¥ element-ui
import ElementUI from 'element-ui';
import 'element-ui/lib/theme-chalk/index.css';
import ElSelectV2 from 'el-select-v2';

Vue.use(ElSelectV2);
```

```vue
<template>
  <el-select-v2 v-model="value" :options="options" />
</template>
<script>
export default {
  data() {
    return {
      options: [],
      value: '',
    };
  },
  created() {
    for (let i = 0; i < 10000; i++) {
      this.options.push({
        value: `value ${i + 1}`,
        label: `label ${i + 1}`,
      });
    }
  },
};
</script>
```

## åˆ†æå®ç°æ€è·¯

æŸ¥çœ‹æºç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æºç çœ‹åˆ°ï¼Œä½¿ç”¨äº† `RecycleScroller` ç»„ä»¶æ¥å®ç°äº†æˆ‘ä»¬çš„è™šæ‹Ÿæ»šåŠ¨ã€‚

## ä½¿ç”¨ `el-select` + `RecycleScroller` å¼€å‘ä¸€ä¸ªè™šæ‹Ÿæ»šåŠ¨ select

```vue
<template>
  <el-select
    v-model="value"
    placeholder="è¯·é€‰æ‹©ç´¢å¼•åç§°"
    filterable
    :filter-method="localFilterMethod"
    ref="select"
  >
    <RecycleScroller
      style="max-height: 250px;"
      class="scroller"
      :items="indexList"
      :min-item-size="34"
      key-field="value"
    >
      <template v-slot="{ item }">
        <el-option :label="item.label" :value="item.value"></el-option>
      </template>
    </RecycleScroller>
  </el-select>
</template>

<script>
export default {
  data() {
    return {
      value: '',
      indexList: [],
    };
  },
  methods: {
    // å½“æˆ‘ä»¬å¼€å¯äº†è¿‡æ»¤åŠŸèƒ½åï¼Œå°±éœ€è¦æ‰‹åŠ¨çš„å»æ›´æ–° 
    // indexList çš„é•¿åº¦ï¼Œä»è€Œæ›´æ–° RecycleScroller çš„å¤§å°
    localFilterMethod(value) {
      // æ›´æ–°çš„æ—¶å€™ï¼Œel-select ä¼šé»˜è®¤ç»™æˆ‘ä»¬æ¸…ç©ºvalue, 
      // æ‰€ä»¥è¦ä¹ˆwatch çš„ é‡æ–°èµ‹å€¼ï¼Œè¦ä¹ˆåœ¨è¿™é‡Œèµ‹å€¼
      this.value = query;
      // âš ï¼š è¿™é‡Œèµ‹å€¼å®é™…ä¸Šæ˜¯ç›´æ¥ä¿®æ”¹äº†æ•°æ®ï¼Œ æˆ‘ä»¬åº”è¯¥ä¿å­˜ä¸€ä»½æ•°æ®ï¼Œ
      // å½“åœ¨åˆ é™¤å€¼çš„æ—¶å€™ï¼Œå°†æ•°æ®è¿˜åŸå†è¿‡æ»¤ä¸€é
      this.indexList = [
        ...this.indexList.filter((option) =>
          option.label.toLowerCase().includes(query.toLowerCase())
        ),
      ];
    },
  },
};
</script>
```

<!-- > [!CAUTION]
> é‡è¦æç¤º

- âš ï¸ el-selectä¸el-checkbox-groupçš„v-model ç»‘å®šçš„å€¼ï¼Œéœ€ç›¸åŒï¼Œç»‘å®šåŒä¸€ä¸ªå˜é‡
- âš ï¸ el-optionçš„valueä¸el-checkboxçš„labelç»‘å®šçš„å€¼ä¹Ÿéœ€è¦ç›¸åŒ
- âš ï¸ el-checkbox éœ€è¦ä½¿ç”¨ style=â€œpointer-events: noneâ€ï¼Œ æ˜¯ä¸ºäº†å»æ‰é¼ æ ‡äº‹ä»¶ï¼Œé˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œè§¦å‘äº†ä¸¤æ¬¡el-selectçš„changeäº‹ä»¶ -->


## æ¡ˆä¾‹

### ElSelectPlus å¤šé€‰ å¯æœç´¢ reserve-keyword ä¿ç•™æŸ¥è¯¢å…³é”®å­—

::: tabs

@tab select.vue
```vue
<template>
  <ElSelectPlus
    :batch="true"
    ref="selectPlus"
    v-model="change_content.index"
    placeholder="è¯·é€‰æ‹©æ‰€éœ€è¦ä¿®æ”¹çš„ç´¢å¼•"
    multiple
    filterable
    :disabled="disabled"
    :options="indexList"
    :reserve-keyword="true"
    collapse-tags
    @change="handleSelect"
    @update-options="updateOptions"
    @close="handleClose"
  >
    <template slot="header">
      <div style="padding: 10px 20px">
        <el-checkbox
          :indeterminate="isIndeterminate"
          v-model="checkAll"
          @change="(val) => handleCheckAllChange(val, 'index')"
          >å…¨é€‰</el-checkbox
        >
      </div>
    </template>
    <template #default="{ item }">
      <el-checkbox-group v-model="change_content.index">
        <el-option :key="item.value" :label="item.label" :value="item.value">
          <el-checkbox style="pointer-events: none" :label="item.value" />
        </el-option>
      </el-checkbox-group>
    </template>
  </ElSelectPlus>
</template>
```

@tab batch.js

```js
export default {
  data() {
      return {
          onceInput: false,
          cahceList: [],
          outerOptions: [],
          isIndeterminate: false,
          checkAll: false,
          query: ''
      }
  },
  methods: {
      handleClose() {
          this.outerOptions = []
      },
      updateOptions(options) {
          this.outerOptions = options
      },
      handleCheckAllChange(val, name = 'indices') {
          const diff = this.outerOptions.length !== 0 ? (this.indexList.length === this.outerOptions.length) : true
          const data = diff ?  [...this.indexList.map(item => item.value)] : [...this.outerOptions.map(item => item.value)] 
          this.change_content[name] = val ? data : [];
          this.isIndeterminate = false;
      },
      handleSelect(value) {
          const checkedCount = value.length;
          this.checkAll = checkedCount === this.indexList.length;
          this.isIndeterminate =
              checkedCount > 0 && checkedCount < this.indexList.length;
      },
  }
}

```
:::