---
title: 在浏览器输入URL按下回车后发生了什么？
createTime: 2022/04/20 10:35:55
author: 李嘉明
permalink: /interview-question/y0fs63f1/
---

::: tip 提问

1. 在浏览器的地址栏输入一个 网址 URL，并按下回车后，发生了什么？

:::

1. 首先对 URL 地址进行解析，分析所需要使用的传输协议和请求的资源路径。如果输入的 URL 不合法，则认为不是一个有效的 URL，
   按下 enter 时会将输入的内容传给搜索引擎；如果输入的 URL 合法，浏览器检查 URL 是否出现了非法字符，
   如果存在则对非法字符进行转译，然后进入到下个过程。

1. 浏览器判断当前 URL 所请求的资源是否在缓存里，如果有缓存且缓存没有失效，则直接返回缓存的资源，否则向服务器发起新的请求。

1. 向服务器发起请求前，需要获取当前域名的 IP 地址，首先先判断本地 DNS 缓存是否有该域名的 DNS 缓存，如果有则使用，如果没有，
   则向 DNS 服务器发起请求，获取域名的 IP 地址，然后把 IP 地址返回给浏览器。

1. 浏览器获得 IP 地址后，通过 TCP 协议进行建立连接的三次握手，成功后，浏览器与服务端建立连接。
   如果是 HTTPS 协议，还需要进行 TSL 四次握手，建立安全连接。

1. 浏览器发起的 URL 请求成功抵达服务器，服务器返回一个 html 文件作为响应。浏览器接收到 html 文件后，开始对 html 文件进行解析。

1. 浏览器首先根据 html 文件进行解析，构建 DOM 树，遇到 link 标签发现 CSS 资源请求时，停止 html 解析，
   请求 CSS 资源并解析为 CSSOM 树后，继续解析 html 文件。

1. 如果遇到 script 标签，则判断是否有声明 defer 或 async 属性，如果都没有，则 script 的加载和执行都会阻塞 html 文档的解析，
   如果声明了 defer 属性，则并行加载 javascript 资源后等待 html 解析完成再执行；
   如果声明了 async 属性，则并行加载 javascript 资源，加载完成后立即执行并阻塞 html 文档解析。

1. 当 DOM 树和 CSSOM 树都解析建立完成，浏览器根据它们构建渲染树，渲染树构建完成后，根据渲染树进行布局。

1. 浏览器布局完成后，使用浏览器的 UI 接口对网页进行绘制，此时整个页面就显示出来了。

1. 最后退出网页后， TCP 开始断开连接的四次挥手过程。
